<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>शुभ दीपावली</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tiro+Devanagari+Hindi:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Tiro Devanagari Hindi', serif;
            text-align: center;
            background: linear-gradient(135deg, #050F77 0%, #222190CF 50%, #0002FF 100%);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            color: #fff;
            overflow-x: hidden;
        }

        #fireworksCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
        }

        .container {
            background: rgba(25, 25, 45, 0.85);
            padding: 0px 0px;
            border-radius: 35px;
            box-shadow: 0 10px 30px rgba(233, 176, 0, 0.3);
            border: 2px solid rgba(233, 176, 0, 0.5);
            max-width: 400px;
            width: 90%;
            z-index: 1;
            backdrop-filter: blur(5px);
            position: relative;
            overflow: hidden;
        }

        .container::before {
            content: '';
            position: absolute;
            top: -0px;
            left: -0px;
            right: -0px;
            bottom: -0px;
            background: linear-gradient(45deg, #ff0, #f80, #f00, #f80, #ff0);
            z-index: -1;
            filter: blur(20px);
            opacity: 0.2;
            animation: borderGlow 5s linear infinite;
        }

        @keyframes borderGlow {
            0% { opacity: 0.3; }
            50% { opacity: 0.6; }
            100% { opacity: 0.3; }
        }

        #laxmiGif {
            max-width: 300px;
            height: auto;
            border-radius: 15px;
            margin-bottom: 10px;
            border: 4px solid #FFD700;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
            transition: transform 0.5s ease;
        }

        .greeting-message {
            font-size: 2.5em;
            font-weight: bold;
            color: #FFD700;
            margin-bottom: 3px;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
            animation: fadeInZoom 1.0s ease-in-out, glow 4s ease-in-out infinite alternate;
            line-height: 1.3;
        }

        @keyframes glow {
            from { text-shadow: 0 0 10px rgba(255, 215, 0, 0.7); }
            to { text-shadow: 0 0 20px rgba(255, 215, 0, 0.9), 0 0 30px rgba(255, 215, 0, 0.5); }
        }

        .greeting-message-sender {
            font-size: 0.8em;
            color: #FFA500;
            display: block;
            margin-top: 2px;
        }

        .input-container {
            margin-top: 3px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            border: 1px solid rgba(255, 215, 0, 0.3);
            box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.2);
        }

        .input-container p {
            font-size: 1.2em;
            color: #FFD700;
            margin-bottom: 3px;
            text-shadow: 0 0 5px rgba(255, 215, 0, 0.3);
        }

        #nameInput {
            padding: 14px 18px;
            border: 2px solid #FFD700;
            border-radius: 10px;
            font-size: 1.2em;
            margin-bottom: 10px;
            width: calc(100% - 40px);
            box-sizing: border-box;
            font-family: 'Tiro Devanagari Hindi', serif;
            background: rgba(0, 0, 0, 0.3);
            color: #fff;
            transition: all 0.3s ease;
        }

        #nameInput:focus {
            outline: none;
            border-color: #FFA500;
            box-shadow: 0 0 15px rgba(255, 165, 0, 0.5);
        }

        #nameInput::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        #generateLinkButton {
            padding: 12px 20px;
            background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.2em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Tiro Devanagari Hindi', serif;
            font-weight: bold;
            width: 100%;
            box-sizing: border-box;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 15px rgba(18, 140, 126, 0.4);
            position: relative;
            overflow: hidden;
        }

        #generateLinkButton:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(18, 140, 126, 0.6);
        }

        #generateLinkButton:active {
            transform: translateY(1px);
        }

        #generateLinkButton::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -60%;
            width: 200%;
            height: 200%;
            background: rgba(255, 255, 255, 0.1);
            transform: rotate(30deg);
            transition: all 0.3s;
        }

        #generateLinkButton:hover::after {
            left: 100%;
        }

        .whatsapp-logo {
            width: 30px;
            height: 30px;
            margin-right: 10px;
            fill: white;
        }

        #generatedLinkContainer {
            margin-top: 10px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            border: 1px dashed #FFD700;
            word-break: break-all;
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        #generatedLinkContainer p {
            font-size: 1.1em;
            color: #FFA500;
            margin-bottom: 12px;
        }

        #generatedLink {
            font-size: 1em;
            color: #fff;
            font-weight: bold;
            display: inline-block;
            margin-right: 5px;
            word-break: break-all;
        }

        .copy-button {
            padding: 10px 18px;
            background: linear-gradient(135deg, #4CAF50 0%, #2E7D32 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            margin-left: 10px;
            transition: all 0.3s ease;
            font-family: 'Tiro Devanagari Hindi', serif;
            vertical-align: middle;
            box-shadow: 0 3px 10px rgba(46, 125, 50, 0.3);
        }

        .copy-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(46, 125, 50, 0.4);
        }

        @keyframes fadeInZoom {
            0% { opacity: 0; transform: scale(0.7); }
            100% { opacity: 1; transform: scale(1); }
        }

        #laxmiGif.animated {
            animation: pulseLaxmi 2s infinite ease-in-out, float 3s ease-in-out infinite;
        }

        @keyframes pulseLaxmi {
            0% { transform: scale(1) translateY(0); }
            50% { transform: scale(1.05) translateY(-10px); }
            100% { transform: scale(1) translateY(0); }
        }

        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-15px); }
            100% { transform: translateY(0px); }
        }

        /* Share options modal */
        .share-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 100;
            justify-content: center;
            align-items: center;
        }
        
        .share-options {
            background: rgba(25, 25, 45, 0.95);
            padding: 20px;
            border-radius: 15px;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 0 20px rgba(255,215,0,0.3);
            border: 1px solid rgba(255,215,0,0.5);
        }
        
        .share-option {
            display: flex;
            align-items: center;
            padding: 15px;
            margin: 10px 0;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .share-option:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }
        
        .share-option img {
            width: 30px;
            height: 30px;
            margin-right: 15px;
        }
        
        .share-option span {
            font-size: 1.1em;
            color: white;
        }
        
        .close-share {
            text-align: right;
            margin-bottom: 15px;
        }
        
        .close-share button {
            background: none;
            border: none;
            color: #FFD700;
            font-size: 1.2em;
            cursor: pointer;
        }

        @media (max-width: 500px) {
            .greeting-message { font-size: 2em; }
            .container { padding: 20px 15px; }
            #laxmiGif { max-width: 220px; }
            .copy-button { margin-left: 0; margin-top: 10px; display: inline-block; }
            #generatedLink { display: block; margin-bottom: 10px; }
            .whatsapp-logo { width: 22px; height: 22px; margin-right: 10px; }
            #generateLinkButton { font-size: 1.1em; padding: 12px; }
            .input-container { padding: 20px; }
        }
    </style>
</head>
<body>
    <script type="text/javascript">
	atOptions = {
		'key' : 'a456cba9ec27a23c96a20c8e373bdd24',
		'format' : 'iframe',
		'height' : 60,
		'width' : 468,
		'params' : {}
	};
</script>
<script type="text/javascript" src="//www.highperformanceformat.com/a456cba9ec27a23c96a20c8e373bdd24/invoke.js"></script>
    <canvas id="fireworksCanvas"></canvas>
    
    <div class="container">
        <img id="laxmiGif" src="laxmi.gif" alt="लक्ष्मी जी एनीमेशन">

        <div id="greetingContainer">
            <!-- Greeting will be inserted here -->
        </div>
        <div class="input-container" id="nameInputSection">
            <p>यह दिवाली शुभकामना अपने नाम से भेजने के लिए, अपना नाम लिखें:</p>
            <input type="text" id="nameInput" placeholder="आपका नाम यहाँ लिखें">
            <button id="generateLinkButton">
                <svg class="whatsapp-logo" viewBox="0 0 90 90" xmlns="http://www.w3.org/2000/svg"><path d="M90 43.84c0 24.21-19.78 43.841-44.18 43.841-7.74 0-15.02-2.601-21.02-6.011L0 90l8.03-23.31c-4.45-6.53-7.02-14.24-7.02-22.85C1.01 19.62 20.79 0 45.82 0 70.22 0 90 19.62 90 43.84zM45.82 6.98c-20.48 0-37.14 16.53-37.14 36.86 0 8.01 2.59 15.53 7.41 21.69l-4.4 12.74 13.18-4.27c5.81 3.98 12.78 6.19 20.95 6.19 20.48 0 37.14-16.53 37.14-36.86S66.3 6.98 45.82 6.98zm0 0" fill-rule="evenodd" fill="currentColor"></path><path d="M62.01 53.5c-1.49-0.74-8.87-4.38-10.24-4.88-1.37-0.5-2.36-0.74-3.35 0.74-0.99 1.49-3.88 4.88-4.76 5.87-0.88 0.99-1.76 1.11-3.25 0.37s-6.33-2.33-12.05-7.44c-4.47-3.98-7.49-8.89-8.37-10.38-0.88-1.49-0.09-2.3 0.65-3.05 0.66-0.66 1.49-1.75 2.23-2.62 0.74-0.88 0.99-1.49 1.49-2.49s0.25-1.86 0.12-2.49c-0.12-0.62-3.22-7.93-4.44-10.85-1.18-2.84-2.42-2.48-3.35-2.53-0.86-0.05-1.85-0.05-2.84-0.05-0.99 0-2.61 0.37-3.98 1.86-1.37 1.49-5.26 5.14-5.26 12.54s5.38 14.54 6.12 15.53c0.74 0.99 10.51 16.02 25.7 22.55 12.71 5.46 15.16 4.37 17.9 4.11 2.74-0.25 8.87-3.63 10.11-7.13 1.24-3.5-1.24-5.41-1.24-5.41z" fill="currentColor"></path></svg>
                Share Now
            </button>
            <div id="generatedLinkContainer" style="display: none;">
                <p>share करने में असमर्थ? यह लिंक कॉपी करें:</p>
                <div>
                    <span id="generatedLink"></span>
                    <button class="copy-button" id="copyLinkButton">copy link</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Share Options Modal -->
    <div class="share-modal" id="shareModal">
        <div class="share-options">
            <div class="close-share">
                <button id="closeShareModal">&times;</button>
            </div>
            <div class="share-option" id="whatsappShare">
                <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="WhatsApp">
                <span>WhatsApp पर शेयर करें</span>
            </div>
            <div class="share-option" id="otherShare">
                <img src="https://cdn-icons-png.flaticon.com/512/159/159069.png" alt="Other">
                <span>अन्य ऐप्स पर शेयर करें</span>
            </div>
        </div>
    </div>

    <script>
        // Enhanced Fireworks Script (without firecrackers)
        const fireworksCanvas = document.getElementById('fireworksCanvas');
        const ctx = fireworksCanvas.getContext('2d');
        let fireworks = [];
        let particles = [];
        let sparks = [];

        function setupCanvas() {
            fireworksCanvas.width = window.innerWidth;
            fireworksCanvas.height = window.innerHeight;
        }

        class Firework {
            constructor(x, y, targetX, targetY, color) {
                this.x = x; 
                this.y = y; 
                this.targetX = targetX; 
                this.targetY = targetY; 
                this.color = color;
                this.speed = 4;
                this.angle = Math.atan2(targetY - y, targetX - x);
                this.coordinates = [];
                this.coordinateCount = 5;
                while(this.coordinateCount--) { 
                    this.coordinates.push([this.x, this.y]); 
                }
                this.tailLength = 15 + Math.random() * 10;
            }
            
            update(index) {
                this.coordinates.pop();
                this.coordinates.unshift([this.x, this.y]);
                
                const speed = this.speed * (1 + Math.random() * 0.2 - 0.1);
                this.x += Math.cos(this.angle) * speed;
                this.y += Math.sin(this.angle) * speed;
                
                if (Math.sqrt((this.targetX - this.x)**2 + (this.targetY - this.y)**2) < this.speed * 1.5) {
                    createParticles(this.targetX, this.targetY, this.color);
                    fireworks.splice(index, 1);
                }
            }
            
            draw() {
                ctx.beginPath();
                ctx.moveTo(this.coordinates[this.coordinates.length - 1][0], 
                            this.coordinates[this.coordinates.length - 1][1]);
                ctx.lineTo(this.x, this.y);
                
                // Create gradient for the firework tail
                const gradient = ctx.createLinearGradient(
                    this.coordinates[this.coordinates.length - 1][0],
                    this.coordinates[this.coordinates.length - 1][1],
                    this.x,
                    this.y
                );
                gradient.addColorStop(0, 'rgba(255,255,255,0.8)');
                gradient.addColorStop(1, this.color);
                
                ctx.strokeStyle = gradient;
                ctx.lineWidth = 3;
                ctx.stroke();
                
                // Draw tail
                for(let i = 1; i < this.coordinates.length; i++) {
                    const alpha = i / this.coordinates.length;
                    ctx.beginPath();
                    ctx.moveTo(this.coordinates[i-1][0], this.coordinates[i-1][1]);
                    ctx.lineTo(this.coordinates[i][0], this.coordinates[i][1]);
                    ctx.strokeStyle = `rgba(255,255,255,${alpha*0.6})`;
                    ctx.lineWidth = 2 * alpha;
                    ctx.stroke();
                }
            }
        }

        class Particle {
            constructor(x, y, color) {
                this.x = x;
                this.y = y;
                this.color = color;
                this.size = Math.random() * 4 + 1;
                this.speed = Math.random() * 8 + 3;
                this.angle = Math.random() * Math.PI * 2;
                this.gravity = 0.2;
                this.alpha = 1;
                this.decay = Math.random() * 0.015 + 0.01;
                this.resistance = 0.98;
                this.flicker = Math.random() > 0.8;
            }
            
            update(index) {
                this.x += Math.cos(this.angle) * this.speed;
                this.y += Math.sin(this.angle) * this.speed + this.gravity;
                this.speed *= this.resistance;
                this.alpha -= this.decay;
                
                if (this.flicker) {
                    this.alpha -= Math.random() * 0.05;
                }
                
                if (this.alpha <= this.decay) {
                    particles.splice(index, 1);
                    // Create a small spark when particle disappears
                    if (Math.random() > 0.7) {
                        createSpark(this.x, this.y, this.color);
                    }
                }
            }
            
            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2, false);
                
                // Create radial gradient for particles
                const gradient = ctx.createRadialGradient(
                    this.x, this.y, 0,
                    this.x, this.y, this.size
                );
                gradient.addColorStop(0, `rgba(255,255,255,${this.alpha})`);
                gradient.addColorStop(0.5, `${this.color.replace(')', `,${this.alpha})`)}`);
                gradient.addColorStop(1, `${this.color.replace(')', `,${this.alpha*0.3})`)}`);
                
                ctx.fillStyle = gradient;
                ctx.fill();
            }
        }

        class Spark {
            constructor(x, y, angle, speed, color, size) {
                this.x = x;
                this.y = y;
                this.angle = angle;
                this.speed = speed;
                this.color = color;
                this.size = size;
                this.alpha = 1;
                this.decay = 0.02 + Math.random() * 0.03;
                this.gravity = 0.1;
            }
            
            update() {
                this.x += Math.cos(this.angle) * this.speed;
                this.y += Math.sin(this.angle) * this.speed + this.gravity;
                this.speed *= 0.95;
                this.alpha -= this.decay;
                this.size *= 0.98;
            }
            
            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fillStyle = `${this.color.replace(')', `,${this.alpha})`)}`;
                ctx.fill();
            }
        }

        function createParticles(x, y, color) {
            const particleCount = 300;
            for (let i = 0; i < particleCount; i++) {
                particles.push(new Particle(x, y, color));
            }
        }

        function createSpark(x, y, color) {
            sparks.push(new Spark(
                x, y, 
                Math.random() * Math.PI * 2,
                Math.random() * 3 + 1,
                color || `hsl(${Math.random() * 60 + 10}, 100%, 50%)`,
                1 + Math.random()
            ));
        }

        const fireworkColors = [
            '#FFD700', '#FF4500', '#FF69B4', '#ADFF2F', '#00FFFF', 
            '#FF1493', '#32CD32', '#FF8C00', '#9370DB', '#00BFFF'
        ];

        function launchFirework() {
            if (fireworks.length < 25) {
                const startX = fireworksCanvas.width / 2;
                const startY = fireworksCanvas.height;
                const targetX = Math.random() * (fireworksCanvas.width * 0.8) + (fireworksCanvas.width * 0.1);
                const targetY = Math.random() * (fireworksCanvas.height * 0.5) + (fireworksCanvas.height * 0.1);
                const color = fireworkColors[Math.floor(Math.random() * fireworkColors.length)];
                
                const firework = new Firework(startX, startY, targetX, targetY, color);
                fireworks.push(firework);
                
                // Occasionally launch a cluster of fireworks
                if (Math.random() > 0.7) {
                    const clusterCount = 3 + Math.floor(Math.random() * 4);
                    for (let i = 0; i < clusterCount; i++) {
                        setTimeout(() => {
                            const offsetX = (Math.random() - 0.5) * 100;
                            const offsetY = (Math.random() - 0.5) * 50;
                            fireworks.push(new Firework(
                                startX, startY, 
                                targetX + offsetX, targetY + offsetY, 
                                color
                            ));
                        }, i * 150);
                    }
                }
            }
        }

        let fireworksInterval;
        function startFireworksShow() {
            if (fireworksInterval) clearInterval(fireworksInterval);
            setupCanvas();
            
            // Initial burst of fireworks
            for (let i = 0; i < 8; i++) {
                setTimeout(launchFirework, i * 300);
            }
            
            fireworksInterval = setInterval(() => {
                launchFirework();
                // Occasionally launch more fireworks at once
                if (Math.random() > 0.7) {
                    const extraCount = 2 + Math.floor(Math.random() * 3);
                    for (let i = 0; i < extraCount; i++) {
                        setTimeout(launchFirework, i * 200);
                    }
                }
            }, 500 + Math.random() * 500);
            
            animateFireworks();
        }

        function stopFireworksShow() {
            clearInterval(fireworksInterval);
            fireworks = [];
            particles = [];
            sparks = [];
            
            if (ctx) {
                ctx.clearRect(0, 0, fireworksCanvas.width, fireworksCanvas.height);
            }
        }

        function animateFireworks() {
            requestAnimationFrame(animateFireworks);
            
            if (ctx && fireworksCanvas.width && fireworksCanvas.height) {
                // Create a subtle gradient background
                const gradient = ctx.createLinearGradient(0, 0, 0, fireworksCanvas.height);
                gradient.addColorStop(0, 'rgba(10, 10, 30, 0.8)');
                gradient.addColorStop(1, 'rgba(5, 5, 15, 0.9)');
                
                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, fireworksCanvas.width, fireworksCanvas.height);
                
                // Draw all elements
                for (let i = 0; i < fireworks.length; i++) {
                    fireworks[i].update(i);
                    fireworks[i].draw();
                }
                
                for (let i = 0; i < particles.length; i++) {
                    particles[i].update(i);
                    particles[i].draw();
                }
                
                for (let i = 0; i < sparks.length; i++) {
                    sparks[i].update();
                    sparks[i].draw();
                    if (sparks[i].alpha <= 0) {
                        sparks.splice(i, 1);
                        i--;
                    }
                }
            }
        }

        window.addEventListener('resize', () => {
            if (getQueryParam('sender')) {
                setupCanvas();
            }
        });

        // Main greeting script
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        function displayGreetingAndFireworks() {
            const senderName = getQueryParam('sender');
            const greetingContainer = document.getElementById('greetingContainer');
            const laxmiGif = document.getElementById('laxmiGif');

            if (senderName) {
                const decodedSenderName = decodeURIComponent(senderName);
                greetingContainer.innerHTML = `
                    <div class="greeting-message">${decodedSenderName} की ओर से <span class="greeting-message-sender">शुभ दीपावली!</span></div>
                `;
                laxmiGif.classList.add('animated');
                startFireworksShow();
            } else {
                greetingContainer.innerHTML = `
                    <div class="greeting-message">शुभ दीपावली!</div>
                `;
                laxmiGif.classList.remove('animated');
                stopFireworksShow();
            }
        }

        function displayLinkForManualCopy(link) {
            const generatedLinkElement = document.getElementById('generatedLink');
            const generatedLinkContainer = document.getElementById('generatedLinkContainer');
            generatedLinkElement.textContent = link;
            generatedLinkContainer.style.display = 'block';
        }

        // Share functionality with WhatsApp priority
        document.getElementById('generateLinkButton').addEventListener('click', function() {
            const name = document.getElementById('nameInput').value.trim();
            if (name === "") {
                alert("कृपया अपना नाम दर्ज करें।");
                return;
            }
            
            const baseUrl = window.location.origin + window.location.pathname;
            const generatedLink = `${baseUrl}?sender=${encodeURIComponent(name)}`;
            
            // Store the generated link for use in share options
            document.getElementById('generatedLink').textContent = generatedLink;
            
            // Show share options modal
            document.getElementById('shareModal').style.display = 'flex';
        });

        // WhatsApp share handler
        document.getElementById('whatsappShare').addEventListener('click', function() {
            const name = document.getElementById('nameInput').value.trim();
            const baseUrl = window.location.origin + window.location.pathname;
            const generatedLink = `${baseUrl}?sender=${encodeURIComponent(name)}`;
            const senderDisplayName = decodeURIComponent(name);
            
            const whatsappMessage = `${senderDisplayName} आपको दीपावली की हार्दिक शुभकामनाएँ भेज रहे हैं! इस विशेष संदेश को देखने के लिए क्लिक करें: ${generatedLink}`;
            const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(whatsappMessage)}`;
            
            window.open(whatsappUrl, '_blank');
            document.getElementById('shareModal').style.display = 'none';
        });

        // Other share handler
        document.getElementById('otherShare').addEventListener('click', async function() {
            const name = document.getElementById('nameInput').value.trim();
            const baseUrl = window.location.origin + window.location.pathname;
            const generatedLink = `${baseUrl}?sender=${encodeURIComponent(name)}`;
            const senderDisplayName = decodeURIComponent(name);

            const shareData = {
                title: 'शुभ दीपावली!',
                text: `${senderDisplayName} आपको दीपावली की हार्दिक शुभकामनाएँ भेज रहे हैं! इस विशेष संदेश को देखने के लिए क्लिक करें:`,
                url: generatedLink
            };

            if (navigator.share) {
                try {
                    await navigator.share(shareData);
                } catch (err) {
                    displayLinkForManualCopy(generatedLink);
                    if (err.name !== 'AbortError') {
                        alert("शेयर करने में असमर्थ। कृपया लिंक को मैन्युअल रूप से कॉपी करें।");
                    }
                }
            } else {
                displayLinkForManualCopy(generatedLink);
                alert("आपका ब्राउज़र सीधे शेयरिंग का समर्थन नहीं करता है। कृपया लिंक को मैन्युअल रूप से कॉपी करें।");
            }
            
            document.getElementById('shareModal').style.display = 'none';
        });

        // Close modal handler
        document.getElementById('closeShareModal').addEventListener('click', function() {
            document.getElementById('shareModal').style.display = 'none';
        });

        document.getElementById('copyLinkButton').addEventListener('click', function() {
            const linkText = document.getElementById('generatedLink').textContent;
            navigator.clipboard.writeText(linkText).then(function() {
                alert('लिंक कॉपी हो गया!');
            }, function(err) {
                alert('लिंक कॉपी करने में विफल: ' + err);
            });
        });

        window.onload = function() {
            displayGreetingAndFireworks();
        };
    </script>
</body>
</html>
<script type="text/javascript">
	atOptions = {
		'key' : 'a456cba9ec27a23c96a20c8e373bdd24',
		'format' : 'iframe',
		'height' : 60,
		'width' : 468,
		'params' : {}
	};
</script>
<script type="text/javascript" src="//www.highperformanceformat.com/a456cba9ec27a23c96a20c8e373bdd24/invoke.js"></script>
